# Elixir_Assignment-3

Project Description:
This project mainly provides details of all the Diseases, Drugs, Hospitals and the Diagnosis details of the patient. It includes data gathering from various data sources. The gathered data is preprocessed according to the database structure and schema. A detail audit of the data sources is made.

Audit:
Diagnosis Data :
Relevancy: The data should meet the requirements for the intended use.

Comments: Data created by HealthMan â€“ a not for profit organisation dedicated to manage the 
functioning of Hospitals in a professional and optimal manner.

Completeness: The data should not have missing values or miss data records.

Comments: 
        Bed Grade                            	 113
        City_Code_Patient                    4532
   
Above are null value counts. 
Diagosis - Filling with "null" value 
Bed Grade - Filling with mean value of bed grade 
                
Consistency:the data should have the data format as expected and can be cross reference-able with the same results.
    
Comments:
 Age and Stay have interval values
 Diagnosis - Mean of the interval taken

Hospitals
Relevancy: The data should meet the requirements for the intended use.

Comments: This dataset is provided by the Homeland Infrastructure Foundation-Level Data (HIFLD)             without a licence and for Public Use.

Completeness: the data should not have missing values or miss data records.
 
Comments: 
        	  TTL_STAFF                              
            Have constant value -999.        
            Diagnosis - We have dropped the column as there is no information in TTL_STAFF
                
            WEBSITE                                377 ARE NOT AVAILABLE. 
Diagnosis - Mode Imputation will lead to wrong websites to hospitals. So filled null values with empty string.

Consistency: The data should have the data format as expected and can be cross reference-able with the same results.
 
Comments:
           Data format is as need to directly join with diagnosis data.No preprocessing is done.

Drugs:

Relevancy: The data should meet the requirements for the intended use.
Comments:
         	This dataset is created from web scraping of various health websites 

Completeness: the data should not have missing values or miss data records.

Comments: 
            There are no missing values in diseases-drugs data. 

 Consistency: The data should have the data format as expected and can be cross reference-able with the same results.

Comments: Data format is as need to directly join with diagnosis data.No preprocessing is done.


Use Cases:
Which city needs more health care attention?

SELECT max(cases_count) as cases_count, cityCodePatient  
from (SELECT count(caseId) as cases_count, cityCodePatient from Diagnosis group by cityCodePatient);

List of patients who were referred to multiple hospitals for a given city.

SELECT count(DISTINCT Diagnosis.hospitalCode) as hospital_count, Diagnosis.patientid, Patients.name, Hospitals.city FROM Diagnosis JOIN Patients on Patients.patientid=Diagnosis.patientid 
JOIN Hospitals on Hospitals.hospitalCode=Diagnosis.hospitalCode
GROUP by Diagnosis.patientid HAVING hospital_count>3 AND Hospitals.city='tillamook';

Prediction of disease based on a particular symptom

SELECT DISTINCT disease FROM Diseases WHERE symptoms like '%abdominal pain%';

What is the most prevalent disease in the city and what are its symptoms?

SELECT max(max_cases) as cases_number, disease_name, symptoms
FROM (SELECT count(caseId) as max_cases, Diagnosis.disease_id as disease_id, Diseases.disease as disease_name, symptoms
FROM Diagnosis JOIN Diseases on Diseases.disease_id=Diagnosis.disease_id
WHERE hospitalCode in (SELECT hospitalCode FROM Hospitals WHERE city like '%baltimore%') GROUP by Diagnosis.disease_id);

Identify the list of all the patients less than a particular age affected by a particular disease in extreme severity and urgent admission.

SELECT DISTINCT Patients.patientid, Patients.name FROM Diagnosis as dgs JOIN Diseases as dis on dis.disease_id=dgs.disease_id 
JOIN Patients on Patients.patientid=dgs.patientid WHERE dis.disease like '%bipolar disorder%' AND severityOfIllness='Extreme' AND typeOfAdmission='Urgent' AND age<30;

Total revenue generated by a particular hospital with admission deposits on a particular date.

SELECT dgs.hospitalCode, hos.name, sum(admissionDeposit) as totalAdmissionDeposit FROM Diagnosis as dgs JOIN Hospitals as hos on hos.hospitalCode=dgs.hospitalCode WHERE startDate='2022-09-28' AND dgs.hospitalCode=28;

List of patients who underwent diagnosis in a particular hospital for a given department 

SELECT DISTINCT Patients.patientid, Patients.name FROM Diagnosis JOIN Patients on Patients.patientid=Diagnosis.patientid
WHERE startDate BETWEEN '2022-04-01' AND '2022-05-01' AND hospitalCode=19 AND department='radiotherapy';

Number of case registrations for all the hospitals in a given duration.

SELECT count(caseId) as registrations_count, Diagnosis.hospitalCode, name FROM Diagnosis JOIN Hospitals on Hospitals.hospitalCode=Diagnosis.hospitalCode WHERE startDate BETWEEN '2021-03-01' AND '2021-04-01' GROUP by Diagnosis.hospitalCode;

List of patients whose length of stay is maximum in a given hospital along with age and name of the patient.

SELECT DISTINCT disease, Patients.name, age FROM Diagnosis JOIN Diseases on Diseases.disease_id=Diagnosis.disease_id 
JOIN Patients on Patients.patientid=Diagnosis.patientid WHERE stay=120 AND hospitalCode=5;

Hospital details where the available beds are greater than 25

SELECT name, beds, telephone, website, zipcode FROM Hospitals WHERE beds>25;


Datasources:

Medicine_prescription_records:
https://www.kaggle.com/datasets/manncodes/drug-prescription-to-disease-dataset

Hospitals:
https://www.kaggle.com/datasets/carlosaguayo/usa-hospitals

diseases to drug:
https://www.kaggle.com/datasets/manncodes/drug-prescription-to-disease-dataset?resource=download

patients disease (diagnosis):
https://datahack.analyticsvidhya.com/contest/janatahack-healthcare-analytics-ii/

Diagnosis:
https://datahack.analyticsvidhya.com/contest/janatahack-healthcare-analytics-ii/#ProblemStatement
